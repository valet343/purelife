<section class="subscribe">
  <div class="container">
    <div class="subscribe_content">
      <div class="subscribe_content_left">
        <p>{{ heading_title }}</p>
        <span>{{ html }}</span>
      </div>
      <div class="subscribe_content_right newsletter_module">
      	<div id="respond" class="{{ module }}"></div>
      	<div class="input-group">
			<input type="text" id="email{{ module }}" name="email" class="form-control" placeholder="{{ entry_email }}" />
			<span id="button-subscribe" class="{{ module }} input-group-addon btn btn-primary">{{ button_subscribe }}</span>
		</div>
      </div>
    </div>
  </div>
</section>
<script>
$(document).ready(function() {
	$('.newsletter_box input[name=\'email{{ module }}\']').bind('keydown', function(e) {
		if (e.keyCode == 13) {
			$('#button-subscribe{{ module }}').trigger('click');
		}
	});
	$('#button-subscribe.{{ module }}').on('click', function() {
		$.ajax({
			url: 'index.php?route=extension/module/newsletter/subscribe',
			type: 'post',
			dataType: 'json',
			data: 'email=' + encodeURIComponent($('input[id=\'email{{ module }}\']').val()),
			success: function(json) {
				$('.text-success, .text-danger').remove();
				if (json['error']) {
					if($('.alert-item-modal-push').length < 1) {
		              $('body').append('<ul class="alert-modal alert-item-modal-push"></ul>');
		            }
		            if($('.alert-item').length = 6) {
		              $('.alert-item').eq(5).prevAll(".alert-item").remove();
		            }
		            var $alertItem = $('<li class="alert-item alert-error">' + json['error'] + '<button class="btn-close btn-close-alert-modal"></button></li>').addClass("alert-item-animate");
		            $(".alert-item-modal-push").prepend($alertItem);
		            setTimeout(function() {
		                $alertItem.remove();
		            }, 2400);
				}
				if (json['success']) {
					if($('.alert-item-modal-push').length < 1) {
		              $('body').append('<ul class="alert-modal alert-item-modal-push"></ul>');
		            }
		            if($('.alert-item').length = 6) {
		              $('.alert-item').eq(5).prevAll(".alert-item").remove();
		            }
		            var $alertItem = $('<li class="alert-item alert-success">' + '{{ success_message }}' + '<button class="btn-close btn-close-alert-modal"></button></li>').addClass("alert-item-animate");
		            $(".alert-item-modal-push").prepend($alertItem);
		            setTimeout(function() {
		                $alertItem.remove();
		            }, 2400);
					$.cookie( 'newsletter_already_added' , 1 , { expires: 14 , path: '/' });
					$('input[id=\'email{{ module }}\']').val('');
				}
				
				$(".btn-close-alert-modal, .dropdown-bg").on("click", function() {
	        $(".alert-modal").remove();
	        $('.dropdown-bg').removeClass("active");
	      });

			}
		});
	});
});
</script>
